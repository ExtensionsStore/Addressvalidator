<?xml version="1.0"?>
<!--
/**
 *  Address Validator
 *
 * @category   Aydus
 * @package    Aydus_Addressvalidator
 * @author     Aydus <davidt@aydus.com>
 */
-->
<config>
    <modules>
        <Aydus_Addressvalidator>
            <version>1.4.3</version>
        </Aydus_Addressvalidator>
    </modules>
    <phpunit>
        <suite>
            <modules>
                <Aydus_Addressvalidator />
            </modules>
        </suite>
    </phpunit>      
    <frontend>
        <events>
            <controller_action_postdispatch_checkout_onepage_saveBilling>
                <observers>
                    <addressvalidator_checkaddress>
                            <class>aydus_addressvalidator/observer</class>
                            <method>validateAddress</method>
                        </addressvalidator_checkaddress>
                </observers>
            </controller_action_postdispatch_checkout_onepage_saveBilling>
            <controller_action_postdispatch_checkout_onepage_saveShipping>
                <observers>
                    <addressvalidator_checkaddress>
                            <class>aydus_addressvalidator/observer</class>
                            <method>validateAddress</method>
                        </addressvalidator_checkaddress>
                </observers>
            </controller_action_postdispatch_checkout_onepage_saveShipping>
        </events>     
        <layout>
            <updates>
                <aydus_addressvalidator>
                    <file>aydus/addressvalidator.xml</file>
                </aydus_addressvalidator>
            </updates>
        </layout>		   
    </frontend>        
    <global>
    	<events>
    		<customer_address_save_after>
			    <observers>
			        <addressvalidator_update_address_validated>
			            <class>aydus_addressvalidator/observer</class>
			            <method>updateAddressValidated</method>
			        </addressvalidator_update_address_validated>
			    </observers>
    		</customer_address_save_after>
    	</events>
        <blocks>
            <aydus_addressvalidator>
                <class>Aydus_Addressvalidator_Block</class>
            </aydus_addressvalidator>
        </blocks>
        <models>
            <aydus_addressvalidator>
                <class>Aydus_Addressvalidator_Model</class>
                <resourceModel>aydus_addressvalidator_resource</resourceModel>
            </aydus_addressvalidator>
            <aydus_addressvalidator_resource>
                <class>Aydus_Addressvalidator_Model_Resource</class>
                <entities>
                    <address>
                        <table>aydus_addressvalidator_addresses</table>
                    </address>
                </entities>
            </aydus_addressvalidator_resource>	            
        </models>
        <helpers>
            <aydus_addressvalidator>
                <class>Aydus_Addressvalidator_Helper</class>
            </aydus_addressvalidator>
            <addressvalidator>
                <class>Aydus_Addressvalidator_Helper</class>
            </addressvalidator>            
        </helpers>
        <resources>
            <aydus_addressvalidator_setup>
                <setup>
                    <module>Aydus_Addressvalidator</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </aydus_addressvalidator_setup>        
        </resources>            
    </global>
    <default>
        <aydus_addressvalidator>
            <configuration>
                <service>usps</service>
                <num_results>5</num_results>
                <num_attempts>3</num_attempts>
                <too_many_attempts_url>contact-us</too_many_attempts_url>
            </configuration>
            <ups>
            	<url>https://onlinetools.ups.com/ups.app/xml/XAV</url>
            </ups>
            <messaging>
                <too_many_attempts>We're sorry, but we are unable to verify your address after several attempts. Please contact Customer Service.</too_many_attempts>
                <matches_available>Address Verification: Please click a verified address below, or click Back to edit your information.</matches_available>
                <invalid_address>Address Verification: No match found; please click Back to edit your information.</invalid_address>
            </messaging>
            <usps>
                <gateway_url><![CDATA[http://production.shippingapis.com/ShippingAPI.dll]]></gateway_url>
            </usps>
            <addressdoctor>
                <valid_exceptions><![CDATA[a:4:{i:0;a:14:{s:12:"country_name";s:6:"Jordan";s:9:"iso3_code";s:3:"JOR";s:2:"V4";i:1;s:2:"V3";i:1;s:2:"V2";i:1;s:2:"V1";i:0;s:2:"C4";i:1;s:2:"C3";i:1;s:2:"C2";i:1;s:2:"C1";i:0;s:2:"I4";i:1;s:2:"I3";i:1;s:2:"I2";i:0;s:2:"I1";i:0;}i:1;a:14:{s:12:"country_name";s:11:"New Zealand";s:9:"iso3_code";s:3:"NZL";s:2:"V4";i:1;s:2:"V3";i:1;s:2:"V2";i:1;s:2:"V1";i:0;s:2:"C4";i:1;s:2:"C3";i:1;s:2:"C2";i:0;s:2:"C1";i:0;s:2:"I4";i:1;s:2:"I3";i:1;s:2:"I2";i:0;s:2:"I1";i:0;}i:2;a:14:{s:12:"country_name";s:12:"Saudi Arabia";s:9:"iso3_code";s:3:"SAU";s:2:"V4";i:1;s:2:"V3";i:1;s:2:"V2";i:1;s:2:"V1";i:0;s:2:"C4";i:1;s:2:"C3";i:1;s:2:"C2";i:1;s:2:"C1";i:0;s:2:"I4";i:1;s:2:"I3";i:1;s:2:"I2";i:0;s:2:"I1";i:0;}i:3;a:14:{s:12:"country_name";s:20:"United Arab Emirates";s:9:"iso3_code";s:3:"ARE";s:2:"V4";i:1;s:2:"V3";i:1;s:2:"V2";i:1;s:2:"V1";i:0;s:2:"C4";i:1;s:2:"C3";i:1;s:2:"C2";i:1;s:2:"C1";i:0;s:2:"I4";i:1;s:2:"I3";i:1;s:2:"I2";i:0;s:2:"I1";i:0;}}]]></valid_exceptions>
            </addressdoctor>
        </aydus_addressvalidator>
    </default>	     
</config>